@if (loading()) {
  <div class="loading">
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
  </div>
} @else if (!hasTasks()) {
  <app-empty-state [variant]="emptyVariant()" (action)="onEmptyAction()" />
} @else {
  <!-- High Priority -->
  @if (tasksByPriority().high.length > 0) {
    <app-section-header title="High Priority" [count]="pendingCounts().high" [total]="tasksByPriority().high.length" />
    @for (task of tasksByPriority().high; track task.id) {
      <app-task-row [task]="task" (statusChange)="onStatusChange(task, $event)" (titleChange)="onTitleChange(task, $event)" (delete)="onDelete(task)" />
    }
  }

  <!-- Medium Priority -->
  @if (tasksByPriority().medium.length > 0) {
    <app-section-header title="Medium Priority" [count]="pendingCounts().medium" [total]="tasksByPriority().medium.length" />
    @for (task of tasksByPriority().medium; track task.id) {
      <app-task-row [task]="task" (statusChange)="onStatusChange(task, $event)" (titleChange)="onTitleChange(task, $event)" (delete)="onDelete(task)" />
    }
  }

  <!-- Low Priority -->
  @if (tasksByPriority().low.length > 0) {
    <app-section-header title="Low Priority" [count]="pendingCounts().low" [total]="tasksByPriority().low.length" />
    @for (task of tasksByPriority().low; track task.id) {
      <app-task-row [task]="task" (statusChange)="onStatusChange(task, $event)" (titleChange)="onTitleChange(task, $event)" (delete)="onDelete(task)" />
    }
  }
}
